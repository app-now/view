String.prototype.hashCode=function(){var hashv=0,i,charv;if(this.length==0){return hashv}for(i=0,l=this.length;i<l;i++){charv=this.charCodeAt(i);hashv=((hashv<<5)-hashv)+charv;hashv|=0}return Math.abs(hashv)};var btEmailLogin=btEmailLogin||{};btEmailLogin=function(){var btmailValue="",smSessionValue="",emailSP="",adsFlag="1",redirect2yahoo=false,t=new Date().getTime(),reportToStm=true,keeploggedin=false,username="",password="",errorCode="",isYmailInst=false,errorsMessages={"100":"TE:Yahoo 100 General","200":"TE:Yahoo 200 Transient database failure","1205":"TE:Yahoo 1205 SSL required","1212":"CE:Yahoo 1212 Invalid credentials","1213":"CE:Yahoo 1213 User account is in antibot state","1214":"CE:Yahoo 1214 Locked in antibot state","1218":"CE:Yahoo 1218 Account Locked","1219":"CE:Yahoo 1219 Challenge invalid","1221":"YA:Email:BT Yahoo 1221 compromised error","1235":"CE:Yahoo 1235 ID does not exist","1236":"TE:Yahooo 1236 System is down","1238":"CE:Yahoo 1238 User under 13","1240":"CE:Yahoo 1240 User in 2nd challenge state","1241":"CE:Yahoo 1241 User 2nd challenge exhausted",YTE:"TE:Yahoo connection",UNPDIVD:"CE:Username or PW invalid","1004":"CE:Barred Inactive","1005":"CE:Inactive","1006":"CE:Expired BTid Contact","1007":"CE:Barred Abuse","1011":"CE:BTid Not Activated","1012":"CE:BTid Not Activated","1013":"CE:BTid Not Activated","1014":"CE:Expired BTid Contact","1015":"CE:Cease Inactive","1018":"CE:Yahoo No Email","1019":"CE:Username or PW invalid","1020":"CE:Username or PW invalid",CECOM:"CE:Compromised",CELOCKED:"CE:Too many login failures, account locked",CEUNE:"CE:UN blank",CEUNI:"CE:UN Invalid",CEPWE:"CE:PW blank","403":"TE:Forbidden error","404":"TE:Page not found error","500":"TE:Internal Server error",NOTMIGRATED:"CE:User not migrated yet","1003":"CE:Invalid SM Headers","1016":"CE:DEFAULT_MAILBOX_STATUS invalid value","1017":"CE:No matching data found in GCP response","1021":"CE:MAILBOX_STATUS Null or empty value",Others:"TE:Unknown Error"},yahooHost="https://login.yahoo.com",ymailInterstitialPage="/yahoo/interstitial",premiumMailInterstitialPage="/s/assets/ymail/premiummail.html",mailClosureInterstitialPage="/s/assets/ymail/mailclosure.html";var config={yahooRedirectUrls:["http://uk.mg.bt.mail.yahoo.com","https://mail.yahoo.com/","https://bt.edit.client.yahoo.com/bt/tier_change_trap?.done=http%3a//uk.mg.bt.mail.yahoo.com","https://bt.edit.client.yahoo.com/bt/tier_change_trap?.done=https%3a//mail.yahoo.com"],showYahooInterstitialPage:false,showMigrationInterstitialPage:false,showProductClosureInterstitialPage:false,migrationStartDate:new Date("May 11, 2014"),daysDelay:0,maxMigratedAccountIdWeekly:[3000000,5000000,6350000,7600000,8660000,9630000,10540000,11360000,12130000,12845000,13545000,14227000,14860000,15410000,15745000,16061000,16371000,16677000,16980000,17280000,17580001,17880002,18180003,18480004,18780005,19080006,19380007,19680008,19980009,20280010]};function getUserStatus(){smSessionValue=$.cookie("SMSESSION");if(smSessionValue==null||smSessionValue==""||smSessionValue=="LOGGEDOFF"){return"loggedout"}else{return"loggedin"}}function btmailExists(){btmailValue=$.cookie("BTMAIL");if(btmailValue==null||btmailValue==""){return false}else{return true}}function validateEmail(emailaddr){var emailregex=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/;return emailregex.test(emailaddr)}function validateUserDetails(uname,pwd){$("#invalidcrdntls").css("display","none");var processlogin=true;if((uname==""||uname=="eg.user@btinternet.com")){if($("#btsignin").hasClass("loginbtnemail")){$("#btsignin").removeClass("loginbtnemail").addClass("loginbtngoBT")}$("#usernameerror").removeClass("hideslot");$("#usernameerror").addClass("showslot");$("#usernameemail").addClass("errorbox");reportErrors("CEUNE");processlogin=false}else{$("#usernameerror").removeClass("showslot");$("#usernameerror").addClass("hideslot");$("#usernameemail").removeClass("errorbox")}if(pwd==""){if($("#btsignin").hasClass("loginbtnemail")){$("#btsignin").removeClass("loginbtnemail").addClass("loginbtngoBT")}$("#passworderror").removeClass("hideslot");$("#passworderror").addClass("showslot");$("#passwordemail").addClass("errorbox");reportErrors("CEPWE");processlogin=false}else{$("#passworderror").removeClass("showslot");$("#passworderror").addClass("hideslot");$("#passwordemail").removeClass("errorbox")}if(uname!=""&&pwd!=""&&!validateEmail(uname)){$("#usernameemail").val("eg.user@btinternet.com");$("#passwordemail").val("");$("#invalidcrdntls").css("display","block");if($("#btsignin").hasClass("loginbtnemail")){$("#btsignin").removeClass("loginbtnemail").addClass("loginbtngoBT")}reportErrors("CEUNI");processlogin=false}return processlogin}function errorscenario(reason){$("#errorscenariodetail").html(reason)}function clearerrormessages(){for(i=1;i<=15;i++){$("#emailloginerror"+i).removeClass("showslot");$("#emailloginerror"+i).addClass("hideslot")}}function displayemailloginpage(){if("CP"==emailSP){displayPageView("CP")}else{displayPageView("yahoo")}$("#usernameemail").val("eg.user@btinternet.com");$("#passwordemail").val("");if($("#btsignin").hasClass("loginbtnemail")){$("#btsignin").removeClass("loginbtnemail").addClass("loginbtngoBT")}}function displayPageHeader(){$("#emailpage").removeClass("hideslot");$("#emailpage").addClass("showslot");if("CP"==emailSP){$("#ycust").html("");$("#btcust").removeClass("hideslot");$("#btcust").css("display","table")}else{$("#btcust").html("");$("#ycust").removeClass("hideslot");$("#ycust").css("display","table")}$("#loginarea").css("display","table")}function clearemailloginpage(){$("#loginsectionid").removeClass("showslot");$("#loginarea").addClass("errorlogin");$(".fullskin").addClass("hideslot");$("#loginsectionid").addClass("hideslot");$(".MPUmessage").css("display","none");$("#fulladmpu").css("display","none");$("#billmpu").css("display","none");$("#billboard").css("display","none")}function loginPageView(flag){if(flag==1){$(".loginbody").removeClass("billboardad");$(".loginbody").removeClass("MPUversion");$(".loginbody").removeClass("hideslot");$("#loginarea").css("display","table");$("#loginsectionid").removeClass("hideslot");$("#loginsectionid").addClass("showslot");$("#billmpu").addClass("hideslot");$("#billboard").addClass("hideslot")}if(flag==2){$(".loginbody").removeClass("btyahoologin fulladversion V1");$(".loginbody").removeClass("MPUversion");$(".loginbody").addClass("billboardad");$(".loginbody").removeClass("hideslot");$("#loginarea").css("display","table");$("#loginsectionid").removeClass("hideslot");$("#loginsectionid").addClass("showslot");$("#fulladmpu").addClass("hideslot");$("#billmpu").removeClass("hideslot");$("#billmpu").css("display","table");$("#billboard").removeClass("hideslot");$("#billboard").css("display","table")}if(flag==3){$(".loginbody").removeClass("btyahoologin fulladversion V1");$(".loginbody").removeClass("billboardad");$(".loginbody").addClass("MPUversion");$(".loginbody").removeClass("hideslot");$("#loginarea").css("display","table");$("#loginsectionid").removeClass("hideslot");$("#loginsectionid").addClass("showslot");$("#billmpu").addClass("hideslot");$("#billboard").addClass("hideslot");$("#fulladmpu").removeClass("hideslot");$("#fulladmpu").css("display","block")}}function displayPageView(emailspstatus){var mobileSPViewBT="<span class='needanacc'>Not a BT Mail customer?</span><a href='http://www.bt.com/reg/consumer/displayPage.do?journeyType=consumer_online_registration&page=registration.entryPage'>Sign up <span class='backarrow'></span></a>";var mobileSPViewYahoo="<span class='needanacc'>Don't use BT Yahoo! mail?</span><a href='http://www.bt.com/btmail'>Find out more <span class='backarrow'></span></a>";loginPageView(adsFlag);$(".fullskin").removeClass("hideslot");$("#loginarea").removeClass("errorlogin");$("#emailpage").removeClass("hideslot");$("#emailpage").addClass("showslot");if("yahoo"==emailspstatus){$("#btcust, #btMPUMessage").html("");$("#btMPUMessage").css("display","none");$("#btMPUMessage").removeClass("MPUmessage");$("#yahooMPUMessage").css("display","block");$("#yahooMPUMessage").removeClass("hideslot");$("#yahooMPUMessage").addClass("showslot");$("#ycust").removeClass("hideslot");$("#ycust").css("display","table");$("#EULaw").css("display","table");$(".MPUmessage").css("display","block");$("#emailMobView").html(mobileSPViewYahoo);if(Modernizr.touch){$("#loginkeepmesigin").addClass("hideslot")}}else{if("CP"==emailspstatus){$("#ycust, #yahooMPUMessage").html("");$("#yahooMPUMessage").css("display","none");$("#yahooMPUMessage").removeClass("MPUmessage");$("#btMPUMessage").css("display","block");$("#btMPUMessage").removeClass("hideslot");$("#btMPUMessage").addClass("showslot");$("#btcust").removeClass("hideslot");$("#btcust").css("display","table");$("#loginkeepmesigin").removeClass("hideslot");$("#loginkeepmesigin").css("display","table");$(".MPUmessage").css("display","block");$("#emailMobView").html(mobileSPViewBT)}else{$("#btcust, #btMPUMessage").html("");$("#btMPUMessage").css("display","none");$("#btMPUMessage").removeClass("MPUmessage");$("#yahooMPUMessage").css("display","block");$("#yahooMPUMessage").removeClass("hideslot");$("#yahooMPUMessage").addClass("showslot");$("#ycust").removeClass("hideslot");$("#ycust").css("display","table");$(".MPUmessage").css("display","block");$("#EULaw").css("display","table");$("#emailMobView").html(mobileSPViewYahoo);if(Modernizr.touch){$("#loginkeepmesigin").addClass("hideslot")}}}}function displayerrors(errorid){displayPageHeader();$("#emailloginerror"+errorid).removeClass("hideslot");$("#emailloginerror"+errorid).addClass("showslot")}function invalidcredentials(errorcode){reportErrors(errorcode?errorcode:"UNPDIVD");$("#usernameemail").val("");$("#passwordemail").val("");$("#invalidcrdntls").css("display","block");if($("#btsignin").hasClass("loginbtnemail")){$("#btsignin").removeClass("loginbtnemail").addClass("loginbtngoBT")}}function reportErrors(errorCode,debugParams){reportOmniture(errorCode);if(reportToStm){var addnlParams="";if(debugParams){addnlParams+="&source=v1&status="+debugParams.status;addnlParams+="&username="+debugParams.username;addnlParams+="&smtrapuser="+debugParams.smtrapuser;addnlParams+="&api="+debugParams.api}executeRequest({url:"/logme?code="+errorsMessages[errorCode]+addnlParams,error:function(xhr,status,err){}})}}function reportOmniture(errorCode){s.linkTrackVars="eVar35,prop22,eVar6,prop4";s.eVar35="Con:Email:Login Page:"+errorsMessages[errorCode];s.prop22="Con:Email:Login Page:"+errorsMessages[errorCode];s.tl(this,"o","Con:Email:Login Page:"+errorsMessages[errorCode])}function reportErrorsWithUserName(errorCode,username){reportOmniture(errorCode);if(reportToStm){executeRequest({url:"/logme?code="+errorsMessages[errorCode]+"&email="+username,error:function(xhr,status,err){}})}}function executeRequest(options){var defaults={method:"GET",headers:{Accept:"application/json; charset=utf-8","Content-Type":"application/json; charset=utf-8"},cache:false,beforeSend:function(){},error:function(xhr,status,err){handleError(xhr,status,err,options)},success:function(){}};var settings=$.extend(defaults,options);$.ajax(settings)}function handleError(xhr,status,err,options){var api="not_set";if(options){if(options.url){var ajaxUrl=options.url;if(ajaxUrl.indexOf("/btapps/ymail/pwtoken_get")!=-1){api="ymail_pwtoken_get"}else{if(ajaxUrl.indexOf("/config/pwtoken_get")!=-1){api="config_pwtoken_get"}else{if(ajaxUrl.indexOf("/btapps/ymail/pwtoken_login")!=-1){api="ymail_pwtoken_login"}else{if(ajaxUrl.indexOf("/config/pwtoken_login")!=-1){api="config_pwtoken_login"}else{if(ajaxUrl.indexOf("/btapps/secure/emaillogin")!=-1){api="emaillogin"}else{if(ajaxUrl.indexOf("/btapps/migrationstatus")!=-1){api="migrationstatus"}}}}}}}}var debugParams={};debugParams.status=xhr.status;debugParams.username=username;debugParams.smtrapuser=$.cookie("SM_TRAPUSER");debugParams.api=api;if(username==$.cookie("SM_TRAPUSER")&&xhr.status==401){if(($.cookie("BARRED_REASON"))){if("associated to compromised"==$.cookie("BARRED_REASON").toLowerCase()){errorscenario("Error occured due to 401(BARRED_REASON=COMPROMISED)");reportErrors("CECOM",debugParams);window.location.assign("http://www.bt.com/appsyouraccount/youraccount_recovery/secure/enhanced/recoverybtid.do?oneId="+username)}else{invalidcredentials()}}else{invalidcredentials()}}else{if(404==xhr.status){errorscenario("Error occured due to 404(service down)");clearemailloginpage();reportErrors("404",debugParams);displayerrors(9)}else{if(403==xhr.status){errorscenario("Error occured due to 403(service down)");clearemailloginpage();reportErrors("403",debugParams);displayerrors(9)}else{if(500==xhr.status){errorscenario("Error occured due to 500(Internal Server Error)");clearemailloginpage();reportErrors("500",debugParams);displayerrors(9)}else{if("YES"===$.cookie("SMONDENIEDREDIR")){errorscenario("Error occured due to max login failure attempts");reportErrors("CELOCKED",debugParams);clearemailloginpage();displayerrors(15)}else{errorscenario("Error occured due to 500(Internal Server Error)");clearemailloginpage();reportErrors("Others",debugParams);displayerrors(9)}}}}}}function isBTId(username){var user=username.split("@");if(user.length==2){if("btinternet.com"==user[1]||"btopenworld.com"==user[1]||"talk21.com"==user[1]){return false}}return true}function isInstman(){var instmanCookie=$.cookie("instman");if(instmanCookie){if($.cookie("ytoken")||$.cookie("ytokentmp")){var instmanArr=instmanCookie.replace(/"/g,"").split("|");if(instmanArr.length==2&&instmanArr[0]==CryptoJS.SHA256(username).toString()){return true}}else{return false}}return false}var yMail={handleLogin:function(){var options={url:"/btapps/ymail/pwtoken_get?t="+t,beforeSend:function(jqXHR){jqXHR.setRequestHeader("Authorization","Basic "+Base64.encode(username+":"+password));jqXHR.setRequestHeader("KEEP_LOGGEDIN",keeploggedin?"Y":"N")},success:yMail.handleTokenURL};executeRequest(options)},handleTokenURL:function(data){isYmailInst=data.interstitialFlag;var options={url:data.address,beforeSend:function(jqXHR){jqXHR.setRequestHeader("Authorization","Basic "+Base64.encode(username+":"+password))},success:yMail.handleTokenResponse};executeRequest(options)},handleTokenResponse:function(data){var response=data.split(/[\r\n]+/g);if(response.length==3){yMail.handleInterstitial(response[1])}else{if("1213"===response[0]){reportErrorsWithUserName(response[0],username);window.location.assign("http://www.bt.com/static/includes/account/email/index.html?")}else{if(response[0]=="1212"){invalidcredentials(response[0])}else{if(response[0]=="1235"){cpMail.handleLogin(true)}else{if(response[0]=="1221"){reportErrors(response[0]);window.location.assign("http://www.bt.com/static/includes/account/email/yahoo.html")}else{reportErrors(response[0]);clearemailloginpage();displayerrors(13)}}}}}},handleInterstitial:function(token){if(config.showYahooInterstitialPage){if(isYmailInst==="true"){yMail.redirectToYmail(token,true)}else{if(!isInstman()&&($.cookie("ytoken")||$.cookie("ytokentmp"))&&($.cookie("instmantmp")!==null)&&location.search.indexOf(".done=true")<0){window.location.assign(ymailInterstitialPage);return}else{yMail.redirectToYmail(token,false)}}}else{yMail.redirectToYmail(token,false)}},redirectToYmail:function(token,yinstflag){var options={url:"/btapps/ymail/pwtoken_login?token="+encodeURIComponent(token)+"&login="+username+"&extended="+keeploggedin+"&interstitial="+yinstflag+"&t="+t,success:function(data){if(data==""){reportErrors("YTE")}else{if(yinstflag&&!isInstman()){$.cookie("instmantmp","",{domain:".bt.com",path:"/"});window.location.assign(ymailInterstitialPage)}else{if(data.address){yMail.isTokenValid(data.address)}else{displayemailloginpage()}}}}};executeRequest(options)},isTokenValid:function(addr){var options={url:addr,success:function(data){if($.inArray(data.redirect_url.toLowerCase(),config.yahooRedirectUrls)>-1){window.location.assign(yahooHost+addr)}else{$.cookie("ytoken","",{domain:".bt.com",path:"/",expires:-1});displayemailloginpage()}}};executeRequest(options)}},cpMail={handleLogin:function(addAuthHeaders){$.cookie("SMCHALLENGE","YES",{domain:"bt.com",path:"/",expires:365});var options={url:"/btapps/secure/emaillogin?t="+t,success:cpMail.handleCPMailResponse};if(addAuthHeaders){options.beforeSend=function(jqXHR){jqXHR.setRequestHeader("Authorization","Basic "+Base64.encode(username+":"+password));jqXHR.setRequestHeader("KEEP_LOGGEDIN",keeploggedin?"Y":"N")}}executeRequest(options)},handleCPMailResponse:function(data){var code=data.code;var description=data.description;errorscenario("Error occured due to code="+code+" ,description="+description);switch(code){case 1000:window.location.assign("https://samlfed.bt.com/dantesemailuk.htm");break;case 1001:window.location.assign("http://www.bt.com/appsprofile/secure/mergefrombtemail/mergefromemail.do");break;case 1002:$.cookie("SMSESSION","",{domain:".bt.com",path:"/",expires:-1});displayemailloginpage();break;case 1003:invalidcredentials("1003");break;case 1004:clearemailloginpage();reportErrors("1004");displayerrors(2);break;case 1005:clearemailloginpage();reportErrors("1005");displayerrors(1);break;case 1006:clearemailloginpage();reportErrors("1006");displayerrors(7);break;case 1007:clearemailloginpage();reportErrors("1007");displayerrors(3);break;case 1008:break;case 1009:break;case 1010:window.location.assign("http://www.bt.com/appsprofile/secure/mergefrombtcom/signup.do?contactEmailAddress="+username);break;case 1011:clearemailloginpage();reportErrors("1011");displayerrors(10);break;case 1012:clearemailloginpage();reportErrors("1012");displayerrors(10);break;case 1013:clearemailloginpage();reportErrors("1013");displayerrors(10);break;case 1014:clearemailloginpage();reportErrors("1014");displayerrors(6);break;case 1015:clearemailloginpage();reportErrors("1015");displayerrors(5);break;case 1016:invalidcredentials("1016");break;case 1017:invalidcredentials("1017");break;case 1018:clearemailloginpage();reportErrors("1018");displayerrors(12);break;case 1019:displayemailloginpage();break;case 1020:clearemailloginpage();reportErrors("1020");displayerrors(8);break;case 1021:invalidcredentials("1021");break;case 1022:window.location.assign("https://www.bt.com/appsconsumeraccount/secure/chooseChoice.do?siteArea=con.mya&inst=pc");break;default:errorscenario("Error occured due to default error message");displayerrors(9)}}},profile={handleYMail:function(email){var options={url:"/btapps/migrationstatus?email="+email,success:profile.handleYMailResponse};executeRequest(options)},handleYMailResponse:function(data){if(data.migrationStatus=="COMPLETED"){displayemailloginpage()}else{yMail.handleInterstitial("")}},handleMailLogin:function(){var options={url:"/btapps/migrationstatus?email="+username,success:profile.handleMailLoginResponse};executeRequest(options)},handleMailLoginResponse:function(data){if(data.migrationStatus=="COMPLETED"){cpMail.handleLogin(true)}else{yMail.handleLogin()}}};return{initLogin:function(options){clearerrormessages();clearemailloginpage();config=jqdgh.extend(config,options);$("#emaillogin-form-id").submit(function(e){$("#btsignin").removeClass("loginbtngoBT").addClass("loginbtnemail");e.preventDefault();errorCode="";$("#btsignin").focus();keeploggedin=$("#emailkeepmeloggedin").is(":checked");username=$("#usernameemail").val();password=$("#passwordemail").val();username=username.toLowerCase();var processlogin=validateUserDetails(username,password);if(processlogin){var emailCP=$.cookie("EMAIL_CP");if(emailCP){var usernamehash=CryptoJS.SHA256(username).toString();if(usernamehash==emailCP){cpMail.handleLogin(true);return}else{var emailCPArr=emailCP.replace(/"/g,"").split("|");var ct=new Date();if(emailCPArr.length>1&&usernamehash==emailCPArr[0]&&emailCPArr[1]*1000>ct){yMail.handleLogin();return}}}if(isBTId(username)){cpMail.handleLogin(true);return}profile.handleMailLogin()}});$(".backtolog").click(function(){clearerrormessages();displayemailloginpage()});$("#back2Ymail").click(function(){clearerrormessages();displayemailloginpage()});$("#loginbackbutton").click(function(){parent.history.back();return false});$("#billingaccount").click(function(){window.location.assign("http://www.bt.com/mybt")});emailSP=$.cookie("EMAIL_SP");var loggedinCustomer=getUserStatus()=="loggedin";if(!loggedinCustomer){var xloginExists=$.cookie("XLOGIN");var elbcExists=$.cookie("elbc");var ytoken=$.cookie("ytoken");var ytokentmp=$.cookie("ytokentmp");if(btmailExists()){$.cookie("BTMAIL","",{domain:".bt.com",path:"/",expires:-1})}if(xloginExists&&elbcExists){window.location.assign("https://btmail.bt.com/cp/applink/core/AuthenticateWrapper")}else{if(xloginExists){$.cookie("XLOGIN","",{domain:".bt.com",path:"/",expires:-1})}if(elbcExists){$.cookie("elbc","",{domain:".bt.com",path:"/",expires:-1})}if(ytoken||ytokentmp){var emailCP=$.cookie("EMAIL_CP");if(ytoken){username=ytoken?Base64.decode(ytoken.replace(/"/g,"").split("|")[1]):""}else{username=ytokentmp?Base64.decode(ytokentmp.replace(/"/g,"").split("|")[1]):""}if(emailCP){var yuserhash=CryptoJS.SHA256(username).toString();var emailCPArr=emailCP.replace(/"/g,"").split("|");if(emailCPArr.length>1&&yuserhash==emailCPArr[0]&&emailCPArr[1]*1000>t){yMail.handleInterstitial("");return}}profile.handleYMail(username)}else{displayemailloginpage()}}}else{if(btmailExists()){var smSessionhash=CryptoJS.SHA256(smSessionValue).toString();if(btmailValue===smSessionhash){window.location.assign("https://samlfed.bt.com/dantesemailuk.htm")}else{cpMail.handleLogin()}}else{cpMail.handleLogin()}}}}}();$(function(){btEmailLogin.initLogin(emailConfig)});